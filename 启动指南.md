# GaussDB Web åº”ç”¨å¯åŠ¨æŒ‡å—

## æ–¹å¼ä¸€ï¼šDocker Compose ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰â­

è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨æ•°æ®åº“ã€åç«¯å’Œå‰ç«¯ã€‚

### å‰ç½®è¦æ±‚
- å·²å®‰è£… Docker å’Œ Docker Compose
- ç¡®ä¿ç«¯å£ 80ã€5000ã€5432 æœªè¢«å ç”¨

### å¯åŠ¨æ­¥éª¤

1. **æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•**
```bash
cd E:\GaussDB-WebApp
```

2. **å¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d --build
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
- æ„å»ºåç«¯é•œåƒï¼ˆåŒ…å« Pythonã€Flaskã€Sparkï¼‰
- æ„å»ºå‰ç«¯é•œåƒï¼ˆåŒ…å« Vue.js åº”ç”¨ï¼‰
- å¯åŠ¨ PostgreSQL æ•°æ®åº“ï¼ˆä½œä¸º GaussDB å…¼å®¹é•œåƒï¼‰
- è‡ªåŠ¨æ‰§è¡Œ `init.sql` åˆå§‹åŒ–æ•°æ®åº“è¡¨

3. **æŸ¥çœ‹æœåŠ¡çŠ¶æ€**
```bash
docker-compose ps
```

4. **æŸ¥çœ‹æ—¥å¿—ï¼ˆå¯é€‰ï¼‰**
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# åªæŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs -f backend

# åªæŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs -f frontend

# åªæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs -f gaussdb
```

5. **è®¿é—®åº”ç”¨**
- **å‰ç«¯ç•Œé¢**: http://localhost
- **åç«¯APIå¥åº·æ£€æŸ¥**: http://localhost:5000/api/health
- **æ•°æ®åº“**: 192.168.126.101:26000 (æœ¬åœ°ç¯å¢ƒ) æˆ– localhost:5432 (äº‘ç¯å¢ƒ)

### åœæ­¢æœåŠ¡
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡ï¼ˆä¿ç•™æ•°æ®ï¼‰
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆä¿ç•™æ•°æ®å·ï¼‰
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨å’Œæ•°æ®å·ï¼ˆå®Œå…¨æ¸…ç†ï¼‰
docker-compose down -v
```

### é‡å¯æœåŠ¡
```bash
docker-compose restart
```

---

## æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨

é€‚åˆéœ€è¦ä¿®æ”¹ä»£ç è¿›è¡Œå¼€å‘çš„åœºæ™¯ã€‚

### å‰ç½®è¦æ±‚

**åç«¯ï¼š**
- Python 3.9+
- Java 11+ (Spark éœ€è¦)
- å·²å®‰è£… pip

**å‰ç«¯ï¼š**
- Node.js 16+
- npm æˆ– yarn

**æ•°æ®åº“ï¼š**
- å·²éƒ¨ç½²çš„ GaussDB æˆ– PostgreSQL æ•°æ®åº“

### å¯åŠ¨æ­¥éª¤

#### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨æ•°æ®åº“

å¦‚æœä½ å·²ç»æœ‰ GaussDB æ•°æ®åº“ï¼Œè·³è¿‡æ­¤æ­¥ã€‚

å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥ä½¿ç”¨ Docker å•ç‹¬å¯åŠ¨æ•°æ®åº“ï¼š
```bash
docker run -d \
  --name gaussdb-dev \
  -e POSTGRES_DB=clouddb \
  -e POSTGRES_USER=cloud_user \
  -e POSTGRES_PASSWORD=CloudPassword123! \
  -p 5432:5432 \
  -v $(pwd)/init.sql:/docker-entrypoint-initdb.d/init.sql \
  postgres:13
```

#### ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åç«¯

1. **è¿›å…¥åç«¯ç›®å½•**
```bash
cd backend
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰**
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨æœ¬åœ°é…ç½®ï¼‰**
```bash
# Windows CMD
set ENVIRONMENT=local
set GAUSSDB_HOST=192.168.126.101
set GAUSSDB_PORT=26000
set GAUSSDB_DB=postgres
set GAUSSDB_USER=yu
set GAUSSDB_PASSWORD=gauss@666

# Windows PowerShell
$env:ENVIRONMENT="local"
$env:GAUSSDB_HOST="192.168.126.101"
$env:GAUSSDB_PORT="26000"
$env:GAUSSDB_DB="postgres"
$env:GAUSSDB_USER="yu"
$env:GAUSSDB_PASSWORD="gauss@666"

# Linux/Mac
export ENVIRONMENT=local
export GAUSSDB_HOST=192.168.126.101
export GAUSSDB_PORT=26000
export GAUSSDB_DB=postgres
export GAUSSDB_USER=yu
export GAUSSDB_PASSWORD=gauss@666
```

5. **å¯åŠ¨ Flask åº”ç”¨**
```bash
python app.py
```

åç«¯å°†åœ¨ http://localhost:5000 å¯åŠ¨

#### ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨å‰ç«¯

1. **æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£ï¼Œè¿›å…¥å‰ç«¯ç›®å½•**
```bash
cd frontend
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm run dev
```

å‰ç«¯å¼€å‘æœåŠ¡å™¨å°†åœ¨ http://localhost:3000 å¯åŠ¨

---

## éªŒè¯åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œ

### 1. æ£€æŸ¥åç«¯å¥åº·çŠ¶æ€
åœ¨æµè§ˆå™¨è®¿é—®æˆ–ä½¿ç”¨ curlï¼š
```bash
curl http://localhost:5000/api/health
```

åº”è¯¥è¿”å›ï¼š
```json
{
  "status": "healthy",
  "database": "connected"
}
```

### 2. æ£€æŸ¥å‰ç«¯
åœ¨æµè§ˆå™¨è®¿é—® http://localhostï¼ˆDockerï¼‰æˆ– http://localhost:3000ï¼ˆæœ¬åœ°å¼€å‘ï¼‰

åº”è¯¥çœ‹åˆ°ï¼š
- é¡¶éƒ¨å¯¼èˆªæ ï¼ˆç”¨æˆ·ç®¡ç†ã€äº§å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€é”€å”®åˆ†æï¼‰
- å¯ä»¥æ­£å¸¸åˆ‡æ¢é¡µé¢

### 3. æµ‹è¯•åŠŸèƒ½
- åœ¨"ç”¨æˆ·ç®¡ç†"é¡µé¢æ·»åŠ ä¸€ä¸ªç”¨æˆ·
- åœ¨"äº§å“ç®¡ç†"é¡µé¢æ·»åŠ ä¸€ä¸ªäº§å“
- åœ¨"è®¢å•ç®¡ç†"é¡µé¢åˆ›å»ºä¸€ä¸ªè®¢å•
- åœ¨"é”€å”®åˆ†æ"é¡µé¢æŸ¥çœ‹ç»Ÿè®¡æ•°æ®

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯ï¼š** `port is already allocated` æˆ– `address already in use`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# Windows æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :5000
netstat -ano | findstr :80
netstat -ano | findstr :5432

# ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„
# ä¾‹å¦‚å°† 5000:5000 æ”¹ä¸º 5001:5000
```

### é—®é¢˜2ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š** `database: disconnected` æˆ–è¿æ¥è¶…æ—¶

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆDocker ç½‘ç»œæˆ–å®¿ä¸»æœºç½‘ç»œï¼‰

```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼ˆæœ¬åœ°ç¯å¢ƒï¼‰
psql -h 192.168.126.101 -p 26000 -U yu -d postgres -c "SELECT 1;"

# å¦‚æœä½¿ç”¨äº‘ç¯å¢ƒï¼Œå–æ¶ˆæ³¨é‡Š gaussdb æœåŠ¡åå¯ä»¥ä½¿ç”¨ï¼š
# docker-compose exec gaussdb psql -U cloud_user -d clouddb -c "SELECT 1;"
```

### é—®é¢˜3ï¼šå‰ç«¯æ— æ³•è¿æ¥åç«¯

**é”™è¯¯ä¿¡æ¯ï¼š** `Network Error` æˆ– `CORS error`

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ `frontend/src/services/api.js` ä¸­çš„ API_BASE_URL é…ç½®
3. æ£€æŸ¥ Nginx é…ç½®ï¼ˆDocker æ¨¡å¼ï¼‰

### é—®é¢˜4ï¼šSpark è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š** Spark ç›¸å…³é”™è¯¯

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®ä¿å·²å®‰è£… Java 11+
2. æ£€æŸ¥ JDBC é©±åŠ¨æ˜¯å¦ä¸‹è½½æˆåŠŸ
3. æŸ¥çœ‹åç«¯æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

```bash
# æ£€æŸ¥ Java ç‰ˆæœ¬
java -version

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs backend
```

### é—®é¢˜5ï¼šå‰ç«¯æ„å»ºå¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š** npm install æˆ– build å¤±è´¥

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ¸…é™¤ç¼“å­˜é‡æ–°å®‰è£…
cd frontend
rm -rf node_modules package-lock.json
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

---

## è¿æ¥å¤–éƒ¨ GaussDB æ•°æ®åº“

å¦‚æœä½ å·²ç»æœ‰éƒ¨ç½²å¥½çš„ GaussDB æ•°æ®åº“ï¼Œä¿®æ”¹ `docker-compose.yml`ï¼š

```yaml
services:
  backend:
    environment:
      - GAUSSDB_HOST=your-gaussdb-host-ip
      - GAUSSDB_PORT=your-port
      - GAUSSDB_DB=your-database-name
      - GAUSSDB_USER=your-username
      - GAUSSDB_PASSWORD=your-password
```

ç„¶åæ³¨é‡Šæ‰æˆ–åˆ é™¤ `gaussdb` æœåŠ¡éƒ¨åˆ†ã€‚

---

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢
docker-compose stop

# é‡å¯
docker-compose restart

# å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬æ•°æ®ï¼‰
docker-compose down -v

# è¿›å…¥åç«¯å®¹å™¨
docker-compose exec backend bash

# è¿›å…¥æ•°æ®åº“ï¼ˆæœ¬åœ°ç¯å¢ƒï¼‰
psql -h 192.168.126.101 -p 26000 -U yu -d postgres

# å¦‚æœä½¿ç”¨äº‘ç¯å¢ƒï¼Œå–æ¶ˆæ³¨é‡Š gaussdb æœåŠ¡åå¯ä»¥ä½¿ç”¨ï¼š
# docker-compose exec gaussdb psql -U cloud_user -d clouddb
```

---

## ä¸‹ä¸€æ­¥

åº”ç”¨å¯åŠ¨æˆåŠŸåï¼Œä½ å¯ä»¥ï¼š
1. è®¿é—®å‰ç«¯ç•Œé¢è¿›è¡ŒåŠŸèƒ½æµ‹è¯•
2. æŸ¥çœ‹ API æ–‡æ¡£äº†è§£æ¥å£è¯¦æƒ…
3. æ ¹æ®éœ€è¦ä¿®æ”¹ä»£ç è¿›è¡Œå®šåˆ¶å¼€å‘

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰


